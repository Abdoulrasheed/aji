{% extends 'app/base.html' %}
{% load static humanize %}

{% block main %}
    <div class="page-content">
		<!--Main content-->
		  <div class="col-md-12">
  			<div  id="capture" class="content-box-large">
  				<div class="panel-heading">
					<div class="panel-title">Reports</div>
					<div class="panel-options">
						<a title="Download Image report" id="download_img" href="#" data-rel="reload"><i class="glyphicon glyphicon-download-alt"></i></a>
						<a onclick="location.reload()" data-rel="collapse"><i class="glyphicon glyphicon-refresh"></i></a>
					</div>
				</div>
  				<div class="panel-body">
  				<span id="data_url" url="{% url 'api_load_graph_data' %}"></span>
			<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="example">
						<thead>
							<tr>
								<th>S/No</th>
								<th>Vehicle Type</th>
								<th>Fees</th>
								<th>Date</th>
								<th>Gate No</th>
								<th>Username</th>
							</tr>
						</thead>
						<tbody id="load_data">
							{% for v in data %}
							<tr>
								<td>{{ forloop.counter }}</td>
								<td>{{ v.vehicleType }}</td>
								<td>{{ v.fees }}</td>
								<td>{{ v.datetime }}</td>
								<td>Gate {{ v.gateNum }}</td>
								<td>{{ v.username }}</td>
							</tr>
							{% empty %}
							<tr>
							<p>No record available</p>
							</tr>
							{% endfor %}
						</tbody>
					</table>
  				</div>
  			</div>
		  </div>
		</div>
		{% endblock main %}
		{% block js %}
    	<script src="https://code.jquery.com/jquery.js"></script>
    	<script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
    	<script src="{% static 'app/js/tables.js' %}"></script>
    	<script src="http://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    	<script src="{% static 'app/js/jquery_fileDownload.js' %}"></script>
    	<script src="{% static 'app/js/img_report.js' %}"></script>

    	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
      <script>
        $(function() {
          const url = $("#data_url").attr('url')
          $('input[name="daterange"]').daterangepicker({
              opens: 'left'
            }, function(start, end, label) {

            $.ajax({
              url: url,
              data:{
                'start': start.format('YYYY-MM-DD'),
                'end': end.format('YYYY-MM-DD')
              },

              beforeSend: ()=> {
                alert('b4');
              },

              complete: ()=>{
                alert('complete');
              },

              success: (data)=>{
                alert('success')
              }
            });
          });
        });
      </script>
    	{% endblock js %}
		